{
  "name": "Excel Template",
  "tagline": "A NodeJS module to generate Excel files in .xlsx format from a template created with Excel itself",
  "body": "# Excel (XLSX) Template\r\n\r\n[![Build status](https://api.travis-ci.org/john-ro/xlsx-template.png?branch=in-progress)](http://travis-ci.org/john-ro/xlsx-template)\r\n\r\nThis module provides a means of generating \"real\" Excel reports (i.e. not CSV\r\nfiles) in NodeJS applications.\r\n\r\nThe basic principle is this: You create a template in Excel. This can be\r\nformatted as you wish, contain formulae etc. In this file, you put placeholders\r\nusing a specific syntax (see below). In code, you build a map of placeholders\r\nto values and then load the template, substitute the placeholders for the\r\nrelevant values, and generate a new .xlsx file that you can then serve to the\r\nuser.\r\n\r\n## Placeholders\r\n\r\nPlaceholders are inserted in cells in a spreadsheet. It does not matter how\r\nthose cells are formatted, so e.g. it is OK to insert a placeholder (which is\r\ntext content) into a cell formatted as a number or currecy or date, if you\r\nexpect the placeholder to resolve to a number or currency or date.\r\n\r\n### Scalars\r\n\r\nSimple placholders take the format `${name}`. Here, `name` is the name of a\r\nkey in the placeholders map. The value of this placholder here should be a\r\nscalar, i.e. not an array or object. The placeholder may appear on its own in a\r\ncell, or as part of a text string. For example:\r\n\r\n    | Extracted on: | ${extractDate} |\r\n\r\nmight result in (depending on date formatting in the second cell):\r\n\r\n    | Extracted on: | Jun-01-2013 |\r\n\r\nHere, `extractDate` may be a date and the second cell may be formatted as a\r\nnumber.\r\n\r\n### If Statements\r\n\r\nTruthy variables can be passed as placeholder values to determine if rows\r\nshow or not:\r\n\r\n    | ${if:name}    |\r\n    | ${name}       |\r\n    | ${endif:name} |\r\n\r\nIf the condition is tested to be false, the 3 rows above will not show at\r\nall. If it is tested to be true, the first and third rows will be removed,\r\nbut the second row resolving `${name}` will remain.\r\n\r\nIf statements should only show up under the first column (A). Nesting of if\r\nblocks are allowed.\r\n\r\n### Columns\r\n\r\nYou can use arrays as placeholder values to indicate that the placeholder cell\r\nis to be replicated across columns. In this case, the placeholder cannot appear\r\ninside a text string - it must be the only thing in its cell. For example,\r\nif the placehodler value `dates` is an array of dates:\r\n\r\n    | ${dates} |\r\n\r\nmight result in:\r\n\r\n    | Jun-01-2013 | Jun-02-2013 | Jun-03-2013 |\r\n\r\n### Tables\r\n\r\nFinally, you can build tables made up of multiple rows. In this case, each\r\nplaceholder should be prefixed by `table:` and contain both the name of the\r\nplaceholder variable (a list of objects) and a key (in each object in the list).\r\nFor example:\r\n\r\n    | Name                 | Age                 |\r\n    | ${table:people.name} | ${table:people.age} |\r\n\r\nIf the replacement value under `people` is an array of objects, and each of\r\nthose objects have keys `name` and `age`, you may end up with something like:\r\n\r\n    | Name        | Age |\r\n    | John Smith  | 20  |\r\n    | Bob Johnson | 22  |\r\n\r\nIf a particular value is an array, then it will be repeated across columns as\r\nabove.\r\n\r\n## Generating reports\r\n\r\nTo make this magic happen, you need some code like this:\r\n\r\n    var XlsxTemplate = require('xlsx-template');\r\n\r\n    // Load an XLSX file into memory\r\n    fs.readFile(path.join(__dirname, 'templates', 'template1.xlsx'), function(err, data) {\r\n\r\n        // Create a template\r\n        var template = new XlsxTemplate(data);\r\n\r\n        // Replacements take place on first sheet\r\n        var sheetNumber = 1;\r\n\r\n        // Set up some placeholder values matching the placeholders in the template\r\n        var values = {\r\n                extractDate: new Date(),\r\n                dates: [ new Date(\"2013-06-01\"), new Date(\"2013-06-02\"), new Date(\"2013-06-03\") ],\r\n                people: [\r\n                    {name: \"John Smith\", age: 20},\r\n                    {name: \"Bob Johnson\", age: 22}\r\n                ]\r\n            };\r\n\r\n        // Perform substitution\r\n        template.substitute(sheetNumber, values);\r\n\r\n        // Get binary data\r\n        var data = template.generate();\r\n\r\n        // ...\r\n\r\n    });\r\n\r\nAt this stage, `data` is a string blob representing the compressed archive that\r\nis the `.xlsx` file (that's right, a `.xlsx` file is a zip file of XML files,\r\nif you didn't know). You can send this back to a client, store it to disk,\r\nattach it to an email or do whatever you want with it.\r\n\r\n## Caveats\r\n\r\n* The spreadsheet must be saved in `.xlsx` format. `.xls`, `.xlsb` or `.xlsm`\r\n  won't work.\r\n* Column (array) and table (array-of-objects) insertions cause rows and cells to\r\n  be inserted or removed. When this happens, only a limited number of\r\n  adjustments are made:\r\n    * Merged cells and named cells/ranges to the right of cells where insertions\r\n      or deletions are made are moved right or left, appropriately. This may\r\n      not work well if cells are merged across rows, unless all rows have the\r\n      same number of insertions.\r\n    * Merged cells, named tables or named cells/ranges below rows where further\r\n      rows are inserted are moved down.\r\n  Formulae are not adjusted.\r\n* As a corollary to this, it is not always easy to build formulae that refer\r\n  to cells in a table (e.g. summing all rows) where the exact number of rows\r\n  or columns is not known in advance. There are two strategies for dealing\r\n  with this:\r\n    * Put the table as the last (or only) thing on a particular sheet, and\r\n      use a formula that includes a large number of rows or columns in the\r\n      hope that the actual table will be smaller than this number.\r\n    * Use named tables. When a placeholder in a named table causes columns or\r\n      rows to be added, the table definition (i.e. the cells included in the\r\n      table) will be updated accordingly. You can then use things like\r\n      `TableName[ColumnName]` in your formula to refer to all values in a given\r\n      column in the table as a logical range.\r\n* Placeholders only work in simple cells and tables, pivot tables or\r\n  other such things.\r\n\r\n## Changelog\r\n\r\n### Version 0.0.6\r\n\r\nNew feature added:\r\n\r\n* If statements! Pass in boolean variables to show/hide sections of sheets.\r\n\r\nBug fix:\r\n\r\n* Fix missing compression method.\r\n\r\n### Version 0.0.5\r\n\r\n* Forked from original [xlsx-template](https://github.com/kant2002/xlsx-template) library.\r\n\r\n### Version 0.0.4\r\n\r\nMerged pending pull requests\r\n\r\n* Deletion of the sheets. \r\n\r\n### Version 0.0.3\r\n\r\nMerged a number of overdue pull requests, including:\r\n\r\n* Windows support\r\n* Support for table footers\r\n* Documentation improvements\r\n\r\n### Version 0.0.2\r\n\r\n* Fix a potential issue with the typing of string indices that could cause the\r\n  first string to not render correctly if it contained a substitution.\r\n\r\n### Version 0.0.1\r\n\r\n* Initial release\r\n",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}